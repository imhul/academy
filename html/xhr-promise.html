<!Doctype html>
<html lang="ru">
	<head>
		<meta charset="utf-8">
		<title>XHR + Promise</title>
        <style>
		</style>
	</head>
<body>
  <h2 class="header"></h2>
  <table class="table">
    <tr>
      <th>Name</th>
      <th>Surname</th>
      <th>Age</th>
    </tr>
  </table>
  <script>
	var promise = new Promise(function(resolve, reject){
  var request = new XMLHttpRequest();
  request.open('GET', 'options.json');
  request.send();
  request.addEventListener('load', function(){
    if (request.readyState === request.DONE) {
      if (request.status === 200) {
        resolve(request.response);
      } else {
        reject(request.statusText);
      }
    }
  });
});

promise.then(function(data){
  return new Promise(function(resolve, reject){
    var request = new XMLHttpRequest();
    request.open('GET', data.url);
    request.send();
    request.addEventListener('load', function(){
      if (request.readyState === request.DONE) {
        if (request.status === 200) {
          resolve(request.response);
        } else {
          reject(request.statusText);
        }
      }
    });
  });
}).then(function(data){
  console.log(data);
}, function(error){
  console.log(error);
});
  </script>
</body>
</html>
